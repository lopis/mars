(()=>{"use strict";var s={877:s=>{const e=[];function t(s){for(let t=0;t<e.length;t++)s!==e[t]&&null===e[t].opponent&&new i(s,e[t]).start()}class i{constructor(s,e){this.user1=s,this.user2=e}start(){this.user1.start(this,this.user2),this.user2.start(this,this.user1)}ended(){return this.user1.guess!==GUESS_NO&&this.user2.guess!==GUESS_NO}score(){this.user1.guess===GUESS_ROCK&&this.user2.guess===GUESS_SCISSORS||this.user1.guess===GUESS_PAPER&&this.user2.guess===GUESS_ROCK||this.user1.guess===GUESS_SCISSORS&&this.user2.guess===GUESS_PAPER?(this.user1.win(),this.user2.lose()):this.user2.guess===GUESS_ROCK&&this.user1.guess===GUESS_SCISSORS||this.user2.guess===GUESS_PAPER&&this.user1.guess===GUESS_ROCK||this.user2.guess===GUESS_SCISSORS&&this.user1.guess===GUESS_PAPER?(this.user2.win(),this.user1.lose()):(this.user1.draw(),this.user2.draw())}}class n{constructor(s){this.socket=s,this.game=null,this.opponent=null,this.guess=GUESS_NO}setGuess(s){return!(!this.opponent||s<=GUESS_NO||s>GUESS_SCISSORS||(this.guess=s,0))}start(s,e){this.game=s,this.opponent=e,this.guess=GUESS_NO,this.socket.emit("start")}end(){this.game=null,this.opponent=null,this.guess=GUESS_NO,this.socket.emit("end")}win(){this.socket.emit("win",this.opponent.guess)}lose(){this.socket.emit("lose",this.opponent.guess)}draw(){this.socket.emit("draw",this.opponent.guess)}}s.exports={io:s=>{const i=new n(s);e.push(i),t(i),s.on("disconnect",(()=>{console.log("Disconnected: "+s.id),function(s){e.splice(e.indexOf(s),1)}(i),i.opponent&&(i.opponent.end(),t(i.opponent))})),s.on("guess",(e=>{console.log("Guess: "+s.id),i.setGuess(e)&&i.game.ended()&&(i.game.score(),i.game.start(),storage.get("games",0).then((s=>{storage.set("games",s+1)})))})),console.log("Connected: "+s.id)},stat:(s,e)=>{storage.get("games",0).then((s=>{e.send(`<h1>Games played: ${s}</h1>`)}))}}}},e={};!function t(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return s[i](o,o.exports,t),o.exports}(877)})();